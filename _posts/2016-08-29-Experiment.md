---
layout: post 
title: "통제된 실험"
author: "JKKim"
date: "August 29, 2016"
output: html_document
comments: true 
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 예제 

소아마비 백신을 개발한 조너스 소크 박사 이야기를 들어보셨나요? (아래 링크 참조 <https://ko.wikipedia.org/wiki/조너스_소크>) 


조너스 소크 박사와 그의 연구팀이 개발한 소아마비 백신은 공식적으로 사용되기 이전에 백신이 안전하고 효과적임을  증명하기 위하여 임상실험을 통과해야 했습니다. 

소크가 백신을 개발한 날이 1952년 3월 26일이었으며, 소크는 자신에게 이 백신을 처음 사용해 성공을 거둔 후, 공개적으로 지원자를 모집해 효과를 검증하기 시작했습니다. 1955년 4월 12일, 미국 44개주에서 소크 백신은 부작용이 없는 아주 효과가 좋은 소아마비 예방을 위한 백신이라는 연구결과가 발표되기까지 보건당국은 많은 노력을 기울여 실험을 해야 했습니다. 

처음의 임상 실험 계획은 자원자 모두에게 백신을 투여하여  백신을 받은 어린이들의 소아마비 발병률이 예전보다 더 낮아지는 지를 비교하는 것이었다고 합니다. 하지만 보건통계학자들은 그렇게 해서는 안되고 지원자 집단을 랜덤하게 두 그룹으로 나누어서 하나에는 백신을 주고 다른 하나에는 가짜약(placebo)을 주어서 그 두 집단간의 발병률의 차이를 비교해야 한다고 주장했습니다. 왜 그래야 하는 것일까요?



## 풀이  

통계학에서 가장 중요한 개념 중의 하나는 통제(control)입니다. 비교를 제대로 하려면 동일한 조건에서 비교를 해야 한다는 것이지요. 즉, 실험군(treatment group)과 대조군(control group)과의 차이는 treatment 여부 외에는 없어야 한다는 것입니다. 그래야 인과관계에 대한 과학적인 결론을 얻어낼수 있다는 것입니다. 

만약 처음 계획처럼 자원자 모두에게 백신을 투여한다면 자원자들의 속성이 비자원자들의 속성과 체계적으로 다를수 있습니다. (실제로 자원자 집단의 가계 소득이 평균보다 높았다고 합니다.) 그러면 실험군의 소아마비 발병률이 대조군보다 낮게 나온다 하더라도 이게 백신 때문인지 아니면 소득에 따른 영양상태의 차이와 같은 다른 속성 때문인지 구분해 낼수가 없습니다. 이렇게 두 요인이 엉켜 있어서 자료를 통해서 관심 요인에 의한 효과를 구분해 낼수 없는 경우를 교락(confounding)되었다고 표현합니다. 이런 confounding effect 를 통제하기 위해서 동일한 조건의 대조군을 설정해야 하는데 randomization 이라는 마술이 이를 가능하게 한다는 것입니다. 두 집단을 나눌때 동전을 던저서 앞면이 나오면 실험군에 속하게 하고 뒤면이 나오면 대조군에 속하게 하면 우연히 두 집단의 속성이 다를 가능성이 표본수가 커지면서 급격하게 낮아지게 되는 것입니다. 


이를 통계학적으로 설명하면 다음과 같습니다. T 는 백신 주사 여부를 나타내는 지시변수라고 하고 (T=1 이면 백신을 맞는 경우, T=0 이면 그렇지 않은 경우), $Y_1$은 백신을 받는 사람의 발병 여부를 나타내는 지시 변수, $Y_0$는 백신을 받지 않는 사람의 발병 여부를 나타내는 지시 변수라고 하면 우리는 $T$ 와 $Y=T Y_1 + (1-T)Y_0$ 를 관측하게 됩니다. 이때 우리의 관심 모수는 다음과 같습니다.  
$$ \theta=E(Y_1) - E(Y_0). $$
즉, 실험군의 소아마비 발병률과 대조군의 소아마비 발병률의 차이가 관심이 있는 것입니다. 이 $\theta$ 값이 0보다 작으면 백신이 효과가 있는 것입니다. 그런데 처음 계획처럼 실험을 하면 위의 $\theta$ 을 추정하게 되는 것이 아니라 
$$ E( Y_1 \mid I=1) - E(Y_0 \mid I=0) $$
을 추정하게 됩니다. (여기서 I=1 는 자원자 그룹, I=0 은 비자원자 그룹) 따라서 자원자 그룹이 완전히 random 하게 선택되지 않는 이상 선택편향(selection bias)이 발생할 수 있고 따라서 $\theta$값과는 체제적으로 차이가 나는 연구 결과를 얻게 될 위험이 있게 되는 것입니다. 



## 토론 

1. 통계학은 과학적인 비교를 하고자 하는 학문입니다. 비교의 핵심은 비교 대상을 잘 찾는 것입니다. 만약 비교 대상이 모든 조건에서 잘 통제되었다면 실험후 두 집단의 차이는 treatment 에 의한 효과일 확률이 큽니다. 통제된 실험을 하기 위해서는 random 하게 두 그룹을 나누어 주는 방법이 사용될수 있습니다. 이런 실험을 randomized controlled experiment 라고 합니다. 

2. Randomized controlled experiment 는 실험 이전의 두 집단간의 차이를 줄여줍니다. 그리고는 실험 과정의 차이를 없애기 위해서 treatment 집단과 control 집단에게 동일한 방식으로 주사를 하는 것이 좋습니다. 또한 의사 역시 이 환자가 진짜 백신을 주사받는 것인지 가짜 백신을 주사받는 것인지 모르게 하는 것이 좋습니다. 즉, 환자 뿐만 아니라 의사 역시 이 환자가 treatment 집단인지 control 집단인지 모르도록 하는 것이 실험 과정에서 발생할수 있는 다른 요인을 통제하는데에 좋습니다. 이런 방법을 double-blinded experiment 라고 합니다. 



3. 이렇게 해서 얻어진 자료를 분석하기 위해서 T-test 라는 것을 씁니다. 두 집단의 표본 평균의 차이가 얼마나 통계적으로 유의한 차이가 있는지를 검정하는 방법입니다. 이런 T-test 가 가장 큰 검정효과를 가져오기 위해서는 두 집단의 표본수를 같게 해 주는게 좋습니다. 왜냐하면 $\theta$ 의 추정량인 $\hat{\theta}  = n_1^{-1} \sum_{i=1}^{n_1} Y_{1i} - n_2^{-1} \sum_{i=1}^{n_2} Y_{0i}$ 의 분산은 
$$ V( \hat{\theta}) = \frac{1}{n_1} V(Y_1)+ \frac{1}{n_2}  V(Y_0) $$
인데 $V(Y_1)=V(Y_0)$ 이라면 결국 추정량의 분산은 $n_1=n_2$ 인 경우에 최소화 하기 때문입니다. 만약 $V(Y_1)=V(Y_0)$이 아니라면 최적 표본수는 달라집니다. 이 최적화 문제는 Cauchy-Schwarz 부등식을 이용하여 풀어낼수 있습니다. 해 보시기 바랍니다. 

4. 현실 세계에서는 위의 randomized control experiment 가 항상 가능한 것은 아닙니다. 예를 들어, 담배의 유해성을 알아보기 위해 사람들을 두 집단으로 나누어서 한 집단에는 담배를 피게 하고 다른 집단에는 담배를 못피우게 할수 없는 것입니다. 실험이 아닌 자료에서는 다른 요인을 통제하기가 어렵습니다. 이에 대해서는 다음 시간에 이야기 하도록 하겠습니다. 